generator db {
  provider = "go run github.com/steebchen/prisma-client-go"
}

datasource db {
  provider = "sqlite"
  url      = "file:../mazic-server/pb_data/data.db"
}

model admins {
  id              String @id
  avatar          Int    @default(0)
  email           String @unique(map: "sqlite_autoindex__admins_2")
  tokenKey        String @unique(map: "sqlite_autoindex__admins_3")
  passwordHash    String
  lastResetSentAt String @default("")
  created         String @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
  updated         String @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))

  @@map("_admins")
}

model collections {
  id            String              @id
  system        Boolean             @default(false)
  type          String              @default("base")
  name          String              @unique(map: "sqlite_autoindex__collections_2")
  schema        Unsupported("json") @default(dbgenerated("\"[]\""))
  indexes       Unsupported("json") @default(dbgenerated("\"[]\""))
  listRule      String?
  viewRule      String?
  createRule    String?
  updateRule    String?
  deleteRule    String?
  options       Unsupported("json") @default(dbgenerated("\"{}\""))
  created       String              @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
  updated       String              @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
  externalAuths externalAuths[]

  @@map("_collections")
}

model externalAuths {
  id           String      @id
  collectionId String
  recordId     String
  provider     String
  providerId   String
  created      String      @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
  updated      String      @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
  collections  collections @relation(fields: [collectionId], references: [id], onDelete: Cascade)

  @@unique([collectionId, provider, providerId], map: "_externalAuths_collection_provider_idx")
  @@unique([collectionId, recordId, provider], map: "_externalAuths_record_provider_idx")
  @@map("_externalAuths")
}

model migrations {
  file    String @id
  applied Int

  @@map("_migrations")
}

model params {
  id      String               @id
  key     String               @unique(map: "sqlite_autoindex__params_2")
  value   Unsupported("json")?
  created String               @default("")
  updated String               @default("")

  @@map("_params")
}

model sys_action {
  id        String  @id @default("'r'||lower(hex(randomblob(7)))")
  name      String  @unique(map: "idx_Xj8ydPd") @default("")
  code      String  @unique(map: "idx_AJtI1FK") @default("")
  is_active Boolean @default(false)
  created   String  @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
  updated   String  @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
}

model sys_permission {
  id          String  @id @default("'r'||lower(hex(randomblob(7)))")
  name        String  @unique(map: "idx_cL4UgWL") @default("")
  code        String  @unique(map: "idx_Wk0bqVU") @default("")
  description String  @default("")
  is_active   Boolean @default(false)
  action_id   String  @default("")
  resource_id String  @default("")
  created     String  @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
  updated     String  @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))

  @@unique([resource_id, action_id], map: "idx_5XTOxWW")
}

model sys_resource {
  id        String              @id @default("'r'||lower(hex(randomblob(7)))")
  name      String              @unique(map: "idx_p2vQkRr") @default("")
  code      String              @unique(map: "idx_rK2pHv9") @default("")
  is_active Boolean             @default(false)
  actions   Unsupported("json") @default(dbgenerated("'[]'"))
  created   String              @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
  updated   String              @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
}

model sys_role {
  id          String  @id @default("'r'||lower(hex(randomblob(7)))")
  name        String  @unique(map: "idx_eyiCi8a") @default("")
  description String  @default("")
  is_active   Boolean @default(false)
  created     String  @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
  updated     String  @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
}

model sys_role_permission {
  id            String @id @default("'r'||lower(hex(randomblob(7)))")
  role_id       String @default("")
  permission_id String @default("")
  created       String @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
  updated       String @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))

  @@unique([role_id, permission_id], map: "idx_WKLjlJK")
}

model sys_user {
  id            String              @id @default("'r'||lower(hex(randomblob(7)))")
  email         String              @unique(map: "idx_3q5O1p3") @default("")
  username      String              @unique(map: "idx_1IHlFNg") @default("")
  password_hash String              @default("")
  first_name    String              @default("")
  last_name     String              @default("")
  avatar        String              @default("")
  verified      Boolean             @default(false)
  roles         Unsupported("json") @default(dbgenerated("'[]'"))
  created       String              @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
  updated       String              @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
}

model mz_habits {
  id            String        @id @default("'r'||lower(hex(randomblob(7)))")
  check_in_type String        @default("")
  color         String        @default("")
  metric        String        @default("")
  order         Decimal       @default(0)
  title         String        @default("")
  week_start    String        @default("")
  user_id       String        @default("")
  is_deleted    Boolean       @default(false)
  is_private    Boolean       @default(false)
  api_key       String        @default("")
  created       String        @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
  updated       String        @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
  mz_check_in   mz_check_in[]
}

model mz_statistics {
  habit_id  String  @default("")
  id        String  @id @default("'r'||lower(hex(randomblob(7)))")
  stat_type String  @default("")
  value     Decimal @default(0)
  created   String  @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
  updated   String  @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))

  @@unique([habit_id, stat_type], map: "idx_N6naouA")
}

model mz_streaks {
  id             String               @id @default("'r'||lower(hex(randomblob(7)))")
  habit_id       String               @default("")
  current_streak Decimal              @default(0)
  longest_streak Decimal              @default(0)
  streak_days    Unsupported("json")?
  created        String               @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
  updated        String               @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
}

model mz_check_in {
  id        String    @id @default("'r'||lower(hex(randomblob(7)))")
  habit_id  String    @default("")
  date      String    @default("")
  journal   String    @default("")
  value     Decimal   @default(0)
  is_done   Boolean   @default(false)
  created   String    @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
  updated   String    @default(dbgenerated("(strftime('%Y-%m-%d %H:%M:%fZ'))"))
  mz_habits mz_habits @relation(fields: [habit_id], references: [id], onDelete: Cascade)

  @@unique([habit_id, date], map: "idx_6nFVz4F")
}
