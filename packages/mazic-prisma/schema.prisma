generator db {
  provider = "go run github.com/steebchen/prisma-client-go"
}

datasource db {
  provider = "sqlite"
  url      = "file:../mazic-server/pb_data/data.db"
}

model admins {
  id              String @id
  avatar          Int    @default(0)
  email           String @unique(map: "sqlite_autoindex__admins_2")
  tokenKey        String @unique(map: "sqlite_autoindex__admins_3")
  passwordHash    String
  lastResetSentAt String @default("")
  created         String @default("strftime('%Y-%m-%d %H:%M:%fZ')")
  updated         String @default("strftime('%Y-%m-%d %H:%M:%fZ')")

  @@map("_admins")
}

model collections {
  id            String              @id
  system        Boolean             @default(false)
  type          String              @default("base")
  name          String              @unique(map: "sqlite_autoindex__collections_2")
  schema        Unsupported("json") @default(dbgenerated("\"[]\""))
  indexes       Unsupported("json") @default(dbgenerated("\"[]\""))
  listRule      String?
  viewRule      String?
  createRule    String?
  updateRule    String?
  deleteRule    String?
  options       Unsupported("json") @default(dbgenerated("\"{}\""))
  created       String              @default("strftime('%Y-%m-%d %H:%M:%fZ')")
  updated       String              @default("strftime('%Y-%m-%d %H:%M:%fZ')")
  externalAuths externalAuths[]

  @@map("_collections")
}

model externalAuths {
  id           String      @id
  collectionId String
  recordId     String
  provider     String
  providerId   String
  created      String      @default("strftime('%Y-%m-%d %H:%M:%fZ')")
  updated      String      @default("strftime('%Y-%m-%d %H:%M:%fZ')")
  collections  collections @relation(fields: [collectionId], references: [id], onDelete: Cascade)

  @@unique([collectionId, provider, providerId], map: "_externalAuths_collection_provider_idx")
  @@unique([collectionId, recordId, provider], map: "_externalAuths_record_provider_idx")
  @@map("_externalAuths")
}

model migrations {
  file    String @id
  applied Int

  @@map("_migrations")
}

model params {
  id      String               @id
  key     String               @unique(map: "sqlite_autoindex__params_2")
  value   Unsupported("json")?
  created String               @default("")
  updated String               @default("")

  @@map("_params")
}

model sys_action {
  code      String  @unique(map: "idx_AJtI1FK") @default("")
  created   String  @default("strftime('%Y-%m-%d %H:%M:%fZ')")
  id        String  @id @default("'r'||lower(hex(randomblob(7)))")
  is_active Boolean @default(false)
  name      String  @unique(map: "idx_Xj8ydPd") @default("")
  updated   String  @default("strftime('%Y-%m-%d %H:%M:%fZ')")
}

model sys_permission {
  action_id   String  @default("")
  code        String  @unique(map: "idx_Wk0bqVU") @default("")
  created     String  @default("strftime('%Y-%m-%d %H:%M:%fZ')")
  description String  @default("")
  id          String  @id @default("'r'||lower(hex(randomblob(7)))")
  is_active   Boolean @default(false)
  name        String  @unique(map: "idx_cL4UgWL") @default("")
  resource_id String  @default("")
  updated     String  @default("strftime('%Y-%m-%d %H:%M:%fZ')")

  @@unique([resource_id, action_id], map: "idx_5XTOxWW")
}

model sys_resource {
  actions   Unsupported("json") @default(dbgenerated("'[]'"))
  code      String              @unique(map: "idx_rK2pHv9") @default("")
  created   String              @default("strftime('%Y-%m-%d %H:%M:%fZ')")
  id        String              @id @default("'r'||lower(hex(randomblob(7)))")
  is_active Boolean             @default(false)
  name      String              @unique(map: "idx_p2vQkRr") @default("")
  updated   String              @default("strftime('%Y-%m-%d %H:%M:%fZ')")
}

model sys_role {
  created     String  @default("strftime('%Y-%m-%d %H:%M:%fZ')")
  description String  @default("")
  id          String  @id @default("'r'||lower(hex(randomblob(7)))")
  is_active   Boolean @default(false)
  name        String  @unique(map: "idx_eyiCi8a") @default("")
  updated     String  @default("strftime('%Y-%m-%d %H:%M:%fZ')")
}

model sys_role_permission {
  created       String @default("strftime('%Y-%m-%d %H:%M:%fZ')")
  id            String @id @default("'r'||lower(hex(randomblob(7)))")
  permission_id String @default("")
  role_id       String @default("")
  updated       String @default("strftime('%Y-%m-%d %H:%M:%fZ')")

  @@unique([role_id, permission_id], map: "idx_WKLjlJK")
}

model sys_user {
  avatar        String              @default("")
  created       String              @default("strftime('%Y-%m-%d %H:%M:%fZ')")
  email         String              @unique(map: "idx_3q5O1p3") @default("")
  first_name    String              @default("")
  id            String              @id @default("'r'||lower(hex(randomblob(7)))")
  last_name     String              @default("")
  password_hash String              @default("")
  roles         Unsupported("json") @default(dbgenerated("'[]'"))
  updated       String              @default("strftime('%Y-%m-%d %H:%M:%fZ')")
  username      String              @unique(map: "idx_1IHlFNg") @default("")
  verified      Boolean             @default(false)
}
